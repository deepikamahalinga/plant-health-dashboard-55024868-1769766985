datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

model Plot {
  id        String     @id @default(uuid()) @db.Uuid
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  soilData  SoilData[]

  @@map("plots")
}

model SoilData {
  id          String   @id @default(uuid()) @db.Uuid
  plotId      String   @db.Uuid
  moisture    Decimal  @db.Decimal(5, 2)
  pH          Decimal  @db.Decimal(4, 2)
  temperature Decimal  @db.Decimal(4, 1)
  timestamp   DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  plot        Plot     @relation(fields: [plotId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@index([plotId, timestamp], type: BTree, name: "idx_soil_data_plot_timestamp")
  @@map("soil_data")
}